{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Sergej\\\\Desktop\\\\Projects\\\\AccnCalProject\\\\calcompass-fe\\\\cal-compass\\\\components\\\\headersParts\\\\headers.js\";\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, IconButton, Typography, Badge, Button } from '@material-ui/core/';\nimport { Menu as MenuIcon, AccountCircle, Notifications as NotificationsIcon, MoreVert as MoreIcon } from '@material-ui/icons';\nimport styleMaker from './headersStyleMaker';\nimport MenuTheme from './menuTheme';\nimport MobileMenu from './mobileMenu';\nimport DesktopMenu from './desktopMenu';\nimport NotificationMenu from './notificationMenu';\nimport Search from './search';\nconst useStyles = makeStyles(styleMaker);\nexport default function PrimarySearchAppBar() {\n  /**\r\n   * @TODO: the user data and headersMetadat should be retrieved through an API call. \r\n   * Eventually they should be brought to getStaticProps or getServerSideProps async functions\r\n   * for data fecthing. \r\n   */\n  const [userData, setUserData] = React.useState(null);\n  const [headersMetadata, setHeadersMetadata] = React.useState(null);\n  const [loggedIn, setLoggedIn] = React.useState(Boolean(userData));\n  const [clickedLoggedOut, setClickedLoggedOut] = React.useState(null); // @TODO - Bring the data fetching to getStaticProps or getServerProps instead of hardcoding them here.\n\n  !userData && !clickedLoggedOut ? fetch('/api/users?id=foo').then(res => res.json()).then(res => {\n    setUserData(res);\n    setLoggedIn(Boolean(res));\n  }).catch(e => console.log(e)) : ''; // @TODO - Delete it once real API is live and adapt code to retrieve information from the API\n\n  !headersMetadata ? fetch('/api/loadHeadersMetadata').then(res => res.json()).then(res => {\n    console.log(res);\n    setHeadersMetadata(res);\n  }).catch(e => console.log(e)) : '';\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const [mobileMoreAnchorEl, setMobileMoreAnchorEl] = React.useState(null);\n  const [notificationAnchorEl, setNotificationAnchorEl] = React.useState(null);\n  const classes = useStyles();\n  const isMenuOpen = Boolean(anchorEl);\n  const isMobileMenuOpen = Boolean(mobileMoreAnchorEl);\n  const isNotificationMenuOpen = Boolean(notificationAnchorEl);\n\n  const handleProfileMenuOpen = e => setAnchorEl(e.currentTarget);\n\n  const handleMobileMenuClose = () => setMobileMoreAnchorEl(null);\n\n  const handleNotificationMenuClose = () => setNotificationAnchorEl(null);\n\n  const handleMenuClose = e => {\n    setAnchorEl(null);\n    handleMobileMenuClose();\n    handleNotificationMenuClose();\n    const {\n      currentTarget: {\n        id\n      }\n    } = e;\n\n    if (id === 'signout') {\n      console.log(id);\n      setClickedLoggedOut(true);\n      setUserData(null);\n      setLoggedIn(null);\n    }\n  };\n\n  const handleMobileMenuOpen = e => setMobileMoreAnchorEl(e.currentTarget);\n\n  const handleNotificationMenuOpen = e => setNotificationAnchorEl(e.currentTarget);\n\n  const notifications = userData ? Array.isArray(userData.notifications) ? userData.notifications : [] : [];\n  const notificationNumber = notifications ? notifications.filter(({\n    visited\n  }) => !visited).length : 0;\n  const menuId = 'account-menu';\n\n  const renderMenu = /*#__PURE__*/_jsxDEV(DesktopMenu, {\n    anchorEl: anchorEl,\n    menuId: menuId,\n    isMenuOpen: isMenuOpen,\n    handleMenuClose: handleMenuClose\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n\n  const mobileMenuId = 'account-menu';\n\n  const renderMobileMenu = /*#__PURE__*/_jsxDEV(MobileMenu, {\n    mobileMoreAnchorEl: mobileMoreAnchorEl,\n    mobileMenuId: mobileMenuId,\n    isMobileMenuOpen: isMobileMenuOpen,\n    handleMobileMenuClose: handleMobileMenuClose,\n    handleProfileMenuOpen: handleProfileMenuOpen,\n    notificationNumber: notificationNumber\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n\n  const notificationMenuId = 'notification-menu';\n\n  const renderNotificationMenu = /*#__PURE__*/_jsxDEV(NotificationMenu, {\n    anchorEl: notificationAnchorEl,\n    menuId: notificationMenuId,\n    isMenuOpen: isNotificationMenuOpen,\n    handleMenuClose: handleNotificationMenuClose,\n    userData: userData ? userData : '' // Defaults it to an empty string.\n    ,\n    setUserData: setUserData\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 35\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.grow,\n    children: [/*#__PURE__*/_jsxDEV(AppBar, {\n      position: \"static\",\n      className: classes.appBar,\n      children: /*#__PURE__*/_jsxDEV(Toolbar, {\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          edge: \"start\",\n          className: classes.menuButton,\n          color: \"inherit\",\n          \"aria-label\": \"open drawer\",\n          children: /*#__PURE__*/_jsxDEV(MenuIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          className: classes.title,\n          variant: \"h6\",\n          noWrap: true,\n          children: headersMetadata ? headersMetadata.appName ? headersMetadata.appName : 'calcompas' : 'calcompass'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this), loggedIn ? /*#__PURE__*/_jsxDEV(Search, {\n          userData: userData ? userData : '',\n          classes: classes\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.grow\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), loggedIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.sectionDesktop,\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": `show ${notificationNumber} new notifications`,\n            \"aria-controls\": notificationMenuId,\n            \"aria-haspopup\": \"true\",\n            variant: \"contained\",\n            onClick: handleNotificationMenuOpen,\n            color: \"inherit\",\n            children: /*#__PURE__*/_jsxDEV(Badge, {\n              badgeContent: notificationNumber,\n              color: \"secondary\",\n              children: /*#__PURE__*/_jsxDEV(NotificationsIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            edge: \"end\",\n            \"aria-label\": \"account of current user\",\n            \"aria-controls\": menuId,\n            \"aria-haspopup\": \"true\",\n            variant: \"contained\",\n            onClick: handleProfileMenuOpen,\n            color: \"inherit\",\n            children: /*#__PURE__*/_jsxDEV(AccountCircle, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this) : '', loggedIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.sectionMobile,\n          children: /*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"show more\",\n            \"aria-controls\": mobileMenuId,\n            \"aria-haspopup\": \"true\",\n            onClick: handleMobileMenuOpen,\n            color: \"inherit\",\n            children: /*#__PURE__*/_jsxDEV(MoreIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this) : '', !loggedIn ? /*#__PURE__*/_jsxDEV(Button, {\n          color: \"inherit\",\n          onClick: () => setClickedLoggedOut(null),\n          children: \"LOGIN\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 24\n        }, this) : '']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this), loggedIn ? /*#__PURE__*/_jsxDEV(MenuTheme, {\n      children: [renderMobileMenu, renderMenu, renderNotificationMenu]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this) : '']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["C:/Users/Sergej/Desktop/Projects/AccnCalProject/calcompass-fe/cal-compass/components/headersParts/headers.js"],"names":["React","makeStyles","AppBar","Toolbar","IconButton","Typography","Badge","Button","Menu","MenuIcon","AccountCircle","Notifications","NotificationsIcon","MoreVert","MoreIcon","styleMaker","MenuTheme","MobileMenu","DesktopMenu","NotificationMenu","Search","useStyles","PrimarySearchAppBar","userData","setUserData","useState","headersMetadata","setHeadersMetadata","loggedIn","setLoggedIn","Boolean","clickedLoggedOut","setClickedLoggedOut","fetch","then","res","json","catch","e","console","log","anchorEl","setAnchorEl","mobileMoreAnchorEl","setMobileMoreAnchorEl","notificationAnchorEl","setNotificationAnchorEl","classes","isMenuOpen","isMobileMenuOpen","isNotificationMenuOpen","handleProfileMenuOpen","currentTarget","handleMobileMenuClose","handleNotificationMenuClose","handleMenuClose","id","handleMobileMenuOpen","handleNotificationMenuOpen","notifications","Array","isArray","notificationNumber","filter","visited","length","menuId","renderMenu","mobileMenuId","renderMobileMenu","notificationMenuId","renderNotificationMenu","grow","appBar","menuButton","title","appName","sectionDesktop","sectionMobile"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { AppBar, Toolbar, IconButton, Typography, Badge, Button } from '@material-ui/core/'\r\nimport { Menu as MenuIcon, AccountCircle, Notifications as NotificationsIcon, MoreVert as MoreIcon} from '@material-ui/icons';\r\nimport styleMaker from './headersStyleMaker'\r\nimport MenuTheme from './menuTheme'\r\nimport MobileMenu from './mobileMenu'\r\nimport DesktopMenu from './desktopMenu'\r\nimport NotificationMenu from './notificationMenu'\r\nimport Search from './search'\r\n\r\n\r\nconst useStyles = makeStyles(styleMaker);\r\n\r\nexport default function PrimarySearchAppBar() {\r\n  \r\n  \r\n  /**\r\n   * @TODO: the user data and headersMetadat should be retrieved through an API call. \r\n   * Eventually they should be brought to getStaticProps or getServerSideProps async functions\r\n   * for data fecthing. \r\n   */\r\n  const [userData, setUserData] = React.useState(null);\r\n  const [headersMetadata, setHeadersMetadata] = React.useState(null)\r\n  const [loggedIn, setLoggedIn] = React.useState(Boolean(userData))\r\n  const [clickedLoggedOut, setClickedLoggedOut] = React.useState(null)\r\n  // @TODO - Bring the data fetching to getStaticProps or getServerProps instead of hardcoding them here.\r\n  \r\n  !userData && !clickedLoggedOut ? fetch('/api/users?id=foo')\r\n    .then(res=>res.json())\r\n    .then(res => {\r\n      setUserData(res)\r\n      setLoggedIn(Boolean(res))\r\n    })\r\n    .catch(e=>console.log(e)) : ''\r\n  // @TODO - Delete it once real API is live and adapt code to retrieve information from the API\r\n  \r\n  !headersMetadata ? fetch('/api/loadHeadersMetadata')\r\n    .then(res=>res.json())\r\n    .then(res=> {\r\n      console.log(res)\r\n      setHeadersMetadata(res)\r\n    })\r\n    .catch(e=>console.log(e)) : ''\r\n\r\n  \r\n  const [anchorEl, setAnchorEl] = React.useState(null)\r\n  const [mobileMoreAnchorEl, setMobileMoreAnchorEl] = React.useState(null)\r\n  const [notificationAnchorEl, setNotificationAnchorEl] = React.useState(null)\r\n\r\n  \r\n  const classes = useStyles();\r\n  const isMenuOpen = Boolean(anchorEl);\r\n  const isMobileMenuOpen = Boolean(mobileMoreAnchorEl)\r\n  const isNotificationMenuOpen = Boolean(notificationAnchorEl)\r\n\r\n  const handleProfileMenuOpen = e => setAnchorEl(e.currentTarget)\r\n\r\n  const handleMobileMenuClose = () => setMobileMoreAnchorEl(null)\r\n  const handleNotificationMenuClose = () => setNotificationAnchorEl(null)\r\n  const handleMenuClose = e => {\r\n    \r\n    setAnchorEl(null)\r\n    handleMobileMenuClose()\r\n    handleNotificationMenuClose()\r\n\r\n    const {currentTarget:{id}} = e\r\n    \r\n    if(id === 'signout'){\r\n      console.log(id)\r\n      setClickedLoggedOut(true)\r\n      setUserData(null)\r\n      setLoggedIn(null)\r\n    }\r\n  };\r\n\r\n  const handleMobileMenuOpen = e => setMobileMoreAnchorEl(e.currentTarget)\r\n  const handleNotificationMenuOpen = e => setNotificationAnchorEl(e.currentTarget)\r\n\r\n\r\n  const notifications = userData ? Array.isArray(userData.notifications) ? userData.notifications : [] :[]\r\n  const notificationNumber = notifications ? notifications.filter(({visited})=>!visited).length:0\r\n\r\n  const menuId = 'account-menu';\r\n  const renderMenu = (\r\n    <DesktopMenu \r\n      anchorEl={anchorEl}\r\n      menuId={menuId}\r\n      isMenuOpen={isMenuOpen}\r\n      handleMenuClose={handleMenuClose}/>\r\n  );\r\n\r\n  const mobileMenuId = 'account-menu';\r\n  const renderMobileMenu = (\r\n    <MobileMenu \r\n      mobileMoreAnchorEl={mobileMoreAnchorEl}\r\n      mobileMenuId={mobileMenuId}\r\n      isMobileMenuOpen={isMobileMenuOpen}\r\n      handleMobileMenuClose={handleMobileMenuClose}\r\n      handleProfileMenuOpen={handleProfileMenuOpen}\r\n      notificationNumber={notificationNumber}\r\n      />\r\n  )\r\n  const notificationMenuId = 'notification-menu'\r\n  const renderNotificationMenu = (<NotificationMenu\r\n      anchorEl={notificationAnchorEl} \r\n      menuId={notificationMenuId}\r\n      isMenuOpen={isNotificationMenuOpen}\r\n      handleMenuClose={handleNotificationMenuClose}\r\n      userData={userData?userData:''}// Defaults it to an empty string.\r\n      setUserData={setUserData}\r\n    />)\r\n\r\n  return (\r\n    <div className={classes.grow}>\r\n      <AppBar position=\"static\" className={classes.appBar}>\r\n        <Toolbar>\r\n          <IconButton\r\n            edge=\"start\"\r\n            className={classes.menuButton}\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography className={classes.title} variant=\"h6\" noWrap>\r\n            {headersMetadata?headersMetadata.appName?headersMetadata.appName:'calcompas':'calcompass'}\r\n          </Typography>\r\n          {loggedIn?<Search userData={userData?userData:''} classes={classes} /> :'' }\r\n          <div className={classes.grow} />\r\n          {loggedIn ? (\r\n          <div className={classes.sectionDesktop}>\r\n            <IconButton \r\n              aria-label={`show ${notificationNumber} new notifications`}\r\n              aria-controls={notificationMenuId}\r\n              aria-haspopup=\"true\"\r\n              variant=\"contained\"\r\n              onClick={handleNotificationMenuOpen}\r\n              color=\"inherit\">\r\n              <Badge badgeContent={notificationNumber} color=\"secondary\">\r\n                <NotificationsIcon />\r\n              </Badge>\r\n            </IconButton>\r\n            <IconButton\r\n              edge=\"end\"\r\n              aria-label=\"account of current user\"\r\n              aria-controls={menuId}\r\n              aria-haspopup=\"true\"\r\n              variant=\"contained\"\r\n              onClick={handleProfileMenuOpen}\r\n              color=\"inherit\"\r\n            >\r\n              <AccountCircle />\r\n            </IconButton>\r\n          </div>) :''}\r\n          {loggedIn? (\r\n          <div className={classes.sectionMobile}>\r\n            <IconButton\r\n              aria-label=\"show more\"\r\n              aria-controls={mobileMenuId}\r\n              aria-haspopup=\"true\"\r\n              onClick={handleMobileMenuOpen}\r\n              color=\"inherit\"\r\n            >\r\n              <MoreIcon />\r\n            </IconButton>\r\n          </div>): ''}\r\n          {!loggedIn ? <Button color='inherit' onClick={()=>setClickedLoggedOut(null)}>LOGIN</Button> : ''}\r\n        </Toolbar>\r\n      </AppBar>\r\n      {loggedIn ? \r\n      <MenuTheme>\r\n        {renderMobileMenu}\r\n        {renderMenu}\r\n        {renderNotificationMenu}\r\n      </MenuTheme>:\r\n      ''}     \r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}